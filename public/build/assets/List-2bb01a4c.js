import{r as t,j as s}from"./app-2b8c7948.js";import{S as j,T as a,P as k}from"./Tooltip-e1082433.js";import{S as N}from"./SpamTypeHelper-95368d74.js";import v from"./Delete-8b78bd37.js";function I(){const[l,i]=t.useState({}),[n,f]=t.useState(1),[m,x]=t.useState(!1),[h,u]=t.useState(null),[c,C]=t.useState(!1),d=new URLSearchParams(window.location.search),p=t.useCallback(e=>{c||u(e)},[c]),g=t.useCallback(()=>{u(null)},[]),y=t.useCallback(e=>{i(r=>({...r,data:r.data.filter(S=>S.id!==e)}))},[]),b=t.useCallback(e=>{f(e),d.set("page",e),window.history.replaceState(null,"",`?${d.toString()}`),l.path&&o(e)},[l.path,d]),o=t.useCallback(async e=>{x(!0);try{const r=await axios.post(route("spam.incoming.paginate",e));i(r.data)}catch(r){console.error("Ошибка:",r)}finally{x(!1)}},[]),w=t.useCallback(e=>new Date(e).toLocaleString(),[]);return t.useEffect(()=>{o(n)},[n,o]),s.jsx("div",{className:"p-4 sm:p-8 bg-white shadow sm:rounded-lg",children:c?s.jsxs("div",{className:"text-center",children:[s.jsx(j,{})," Удаление..."]}):m?s.jsxs("div",{className:"text-center",children:[s.jsx(j,{size:"md"})," Загрузка..."]}):s.jsxs(s.Fragment,{children:[h&&s.jsx(v,{closeModal:g,item:h,onDelete:y,setIsDeleting:C}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(a,{children:[s.jsxs(a.Head,{children:[s.jsx(a.HeadCell,{children:"№"}),s.jsx(a.HeadCell,{style:{minWidth:"24rem"},children:"Текст"}),s.jsx(a.HeadCell,{children:"Категория"}),s.jsx(a.HeadCell,{style:{minWidth:"8rem"},children:"Данные с запроса"}),s.jsx(a.HeadCell,{children:"Время"}),s.jsx(a.HeadCell,{children:"Действия"})]}),s.jsx(a.Body,{className:"divide-y",children:(l==null?void 0:l.data)&&l.data.map(e=>s.jsxs(a.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[s.jsx(a.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:e==null?void 0:e.id}),s.jsx(a.Cell,{className:"break-all",children:(e==null?void 0:e.text.substring(0,250))+"..."}),s.jsx(a.Cell,{children:N.translate(e==null?void 0:e.spam_type)}),s.jsx(a.Cell,{children:e==null?void 0:e.request}),s.jsx(a.Cell,{children:w(e==null?void 0:e.created_at)}),s.jsx(a.Cell,{children:s.jsx("a",{className:"font-medium text-cyan-600 hover:underline dark:text-cyan-500",onClick:()=>p(e),href:"#",children:s.jsx("p",{children:"Удалить"})})})]},e.id))})]})}),s.jsx("div",{className:"flex items-center justify-center text-center",children:(l==null?void 0:l.data)&&(l==null?void 0:l.total)>0&&s.jsx(k,{currentPage:n,onPageChange:b,totalPages:l==null?void 0:l.last_page,nextLabel:"Далее",previousLabel:"Назад"})})]})})}export{I as default};
